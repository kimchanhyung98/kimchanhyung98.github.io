Title: Prevention fraud & early fraud warnings
Subtitle: 사기 예방 및 조기 사기 경고
Category: misc
Date: 2024-12-01 00:00

### 발단

결제 모듈을 여러개 사용함. 국내는 토스, 해외는 페이팔과 스트라이프를 사용함.
서비스가 성장하고 있는 중이라서 그런지, 최근들어 스트라이프에서 분쟁이 발생.
발생한 분쟁들을 확인하니 조기 사기 경고(이하 'EFW'라 칭함)라는 이벤트가 발생했음.

- 결제가 처리되기 전에 스트라이프가 사기성 행동을 사전 탐지했을 때 발생하는 이벤트(조기 사기 경고) 존재.
- https://docs.stripe.com/disputes/measuring#early-fraud-warnings
- https://docs.stripe.com/api/radar/early_fraud_warnings
- 분쟁도 고려 https://docs.stripe.com/disputes/how-disputes-work#early-fraud-warnings

## 조기 사기 경고?

조기 사기 경고는 카드 소유자가 공식적인 환불 청구가 접수되기 전에 발급 은행에 사기 청구를 제기할 때 발생합니다.
Stripe는 사기 활동을 감지하거나 카드 발급 은행에서 사기 가능성에 대한 경고를 받을 때 이 경고를 제공합니다.

전액 환불되지 않은 경우 소송 대상 (경고(EFW)를 받은 요금을 사전에 환불하는 것이 좋음)

## 잠재적 사기 식별?

Early Fraud Warnings 와 같이 결제가 사기일 수 있음을 나타내는 외부 지표가 있지만 사기 활동에는 그 자체로 사기를 명확하게 나타내지 않는 많은 암묵적 지표도 있습니다.
그러나 이러한 지표 중 여러 개가 동시에 존재하면 결제가 사기임을 더 명확하게 시사할 수 있습니다.

- https://docs.stripe.com/disputes/prevention/identifying-fraud

자사의 서비스가 물리적으로 상품을 배송하는게 아니므로, 일반적인 사기 지표와 디지털 상품 또는 서비스를 이용한 사기에 대해서만 확인

### 일반적인 사기 지표 유형

- https://docs.stripe.com/disputes/prevention/identifying-fraud

사기 지표에는 여러 유형이 있으며, 그 중 일부는 거짓 번호나 이메일 주소와 같이 식별하기 쉽고, 다른 유형은 이상해 보이는 고객과의 대화와 같이 더 직관적이고 미묘할 수 있습니다.
사기꾼이 거짓 정보를 사용하여 사기 거래를 하는 다양한 방법을 이해하면 사기꾼을 방지하는 데 더 도움이 됩니다. 가장 일반적인 사기 지표 유형은 다음과 같습니다.

- 거짓일 가능성이 있는 정보를 사용하는 경우(예: asdkf12495@freemail.example.com 과 같은 가짜 전화번호 및 이메일 주소 ).
- 여러 구매에서 고객 세부정보가 일치하지 않는 경우(예: 같은 이메일 주소를 사용하지만 다른 결제에 다른 이름을 사용하는 경우).
- 옳지 않은 의사소통. 사기꾼은 종종 일반적인 문구를 사용하여 여러 판매자에게 보내는 통조림 답변을 사용합니다. 의사소통이 스크립트로 표시되면 검색 엔진을 사용하여(짧은 문구를 따옴표로 묶어) 다른 곳에서
  사용되었는지 확인합니다(예: 이 특정 문구는 여러 번 사용되었습니다).
- 비정상적으로 큰 주문(예: 같은 품목을 여러 개 주문, 가장 비싼 상품만 주문, 비싼 품목 주문, 일반적인 고객 행동과 일치하지 않는 총 주문 금액).
- 다음을 통해 이루어진 많은 결제(거부된 결제 포함):
- 같은 카드인데 배송지 주소가 다르네요.
- 동일한 배송 주소를 사용하는 카드가 많습니다.
- 동일한 IP 주소의 동일한 카드.
- 동일한 고객 이름/이메일 주소.
- 실패한 결제 시도가 모두 다른 신용카드와 연관된 경우, 성공적인 결제가 이루어지더라도 사기 위험이 훨씬 커집니다.
- 비슷하거나 동일한 카드 번호, 특히 단기간 및 소액. 이는 특히 크라우드펀딩/펀드레이징 사이트에서 그렇습니다.

다음에 대한 요청:

- 동일한 검증된 청구 주소 정보를 공유하지 않는 여러 카드로 대량 주문을 여러 번 분할하여 결제합니다.
- 대시보드나 매장을 통해 수동으로 결제를 처리합니다. 사기꾼은 자신의 IP 주소가 아닌 귀하의 로컬 IP 주소로 요금이 청구되도록 이 요청을 할 수 있습니다.
- 필요한 금액 이상을 카드에 청구(일명 "과도한 청구")하고 다른 지불 방법(예: 현금, 송금 수표)을 사용하여 제3자(예: 운전자, 운송업체 또는 화물 운송 회사)에게 지불합니다.
- 카드로 요금을 청구한 후 카드 네트워크 외부에서 환불합니다(예: 수표, 송금).

### 디지털 상품 또는 서비스

디지털 상품이나 서비스를 오용하는 고객은 도난된 신용 카드를 사용할 가능성이 더 높습니다.
CVC, 거리 주소, 우편번호를 포함하여 가능한 한 많은 카드 정보를 수집하고 확인하는 것이 매우 중요합니다.
CVC 및 우편번호 검사에 실패한 청구는 거부하는 것을 고려하세요. 디지털 상품이나 서비스를 판매할 때는 일반적으로 다음을 확인하세요.

- 제품을 사용하여 메시지를 보내거나 다운로드 가능한 콘텐츠나 "게임 내" 아이템을 단시간에 대량 구매하는 스팸을 보내는 고객을 주의하세요.
- 유사한 이메일 주소나 동일한 신용 카드를 사용하는 여러 계정을 주시하세요. 검토 규칙을 통해 검토 대기열에 이를 포함할 수 있습니다 .
- 같은 이메일 주소로 여러 건의 요금이 빠르게 연속으로 청구되는 것을 주의하세요. 검토 규칙을 통해 검토 대기열에 이를 포함할 수 있습니다 .
- 계정 활동에서 예상치 못한 또는 상당한 변화를 주시하십시오. 계정의 구매 빈도 또는 지불 금액이 상당히 증가하면 사기 활동의 징후일 수 있습니다.
- IP 주소, 이메일 로그, 사용 로그(즉, 로그인해서 실제로 서비스를 사용했는가?) 등을 포함한 지불에 대한 증거를 확인하세요. 이 정보를 저희에게 전달하면 요금을 검토할 때 볼 수 있습니다.

### 조기 사기 경고를 받았을 때, 대응 방법은?

"조기 사기 경고" 상태의 기부금을 접하면 환불 및 잠재적 분쟁 수수료의 위험을 최소화하기 위해 신속하게 조치를 취하는 것이 중요합니다. 취해야 할 단계는 다음과 같습니다.

후원자에게 연락하기 : 후원자에게 최대한 빨리 연락하여 기부 의도가 있었는지 또는 거래가 사기라고 생각하는지 확인하세요.
기부금 환불 : 후원자가 거래가 승인되지 않았음을 확인하거나 후원자에게 연락할 수 없는 경우, 주어진 기간(보통 24-48시간) 내에 기부금을 전액 환불하는 것이 가장 좋습니다. 기부금을 환불하는 것은
Stripe에서 분쟁과 잠재적 분쟁 수수료를 방지하는 유일한 방법입니다.
의사소통 기록 : 거래의 적법성 확인이나 후원자의 환불 요청 등을 포함하여 후원자와의 의사소통 기록을 보관하세요.

참고 사항

- dispute(사기 분쟁)을 받은 후에도 EFW를 받을 수 있음
    - EFW 처리 시스템과 분쟁 처리 시스템이 무조건 동기화되지는 않기 때문

- https://docs.stripe.com/api/radar/early_fraud_warnings : EFW Object
- https://docs.stripe.com/radar/reviews : 결제에 대한 수동 검사도 가능함
    - 정상 유저를 고려하여 유저에게 사유 설명 및 결제 방법 변경 유도 ?
- 차단(Blocked)이 된 이후에는, Stripe Blocked Payment 관련 별도 Webhook이나 알림 어려움

## 고려 사항

조기 사기 경고를 처리할 때 다음 사항을 명심하세요.

초기 사기 경고는 Stripe 처리 플랫폼 전체에서 70~90%의 경우 분쟁으로 이어지므로 이를 심각하게 받아들이는 것이 중요합니다.
환불 가능 기간은 보통 24~48시간 이내이므로 신속한 조치가 필요합니다.
조기 사기 경고를 전액 환불하는 것은 Stripe와의 분쟁 및 잠재적 분쟁 수수료를 방지하는 유일한 방법입니다.

